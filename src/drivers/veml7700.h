#ifndef VEML7700_H_
#define VEML7700_H_

#define VEML7700_I2C_ADDRESS  0x10 ///< I2C address

#define VEML7700_ALS_GAIN_x1 0x0   // x 1
#define VEML7700_ALS_GAIN_x2 0x1   // x 2
#define VEML7700_ALS_GAIN_d8 0x2   // x 1/8
#define VEML7700_ALS_GAIN_d4 0x3   // x 1/4

#define VEML7700_ALS_INTEGRATION_25ms 0xc
#define VEML7700_ALS_INTEGRATION_50ms 0x8
#define VEML7700_ALS_INTEGRATION_100ms 0x0
#define VEML7700_ALS_INTEGRATION_200ms 0x1
#define VEML7700_ALS_INTEGRATION_400ms 0x2
#define VEML7700_ALS_INTEGRATION_800ms 0x3

#define VEML7700_ALS_PERSISTENCE_1 0x0
#define VEML7700_ALS_PERSISTENCE_2 0x1
#define VEML7700_ALS_PERSISTENCE_4 0x2
#define VEML7700_ALS_PERSISTENCE_8 0x3

#define VEML7700_ALS_POWER_MODE_1 0x0
#define VEML7700_ALS_POWER_MODE_2 0x1
#define VEML7700_ALS_POWER_MODE_3 0x2
#define VEML7700_ALS_POWER_MODE_4 0x3

#define VEML7700_COMMAND_ALS_SM 0x00
#define VEML7700_ALS_SM_MASK 0x1800
#define VEML7700_ALS_SM_SHIFT 11

#define VEML7700_COMMAND_ALS_IT 0x00
#define VEML7700_ALS_IT_MASK 0x03c0
#define VEML7700_ALS_IT_SHIFT 6

#define VEML7700_COMMAND_ALS_PERS 0x00
#define VEML7700_ALS_PERS_MASK 0x0030
#define VEML7700_ALS_PERS_SHIFT 4

#define VEML7700_COMMAND_ALS_INT_EN 0x00
#define VEML7700_ALS_INT_EN_MASK 0x0002
#define VEML7700_ALS_INT_EN_SHIFT 1

#define VEML7700_COMMAND_ALS_SD 0x00
#define VEML7700_ALS_SD_MASK 0x0001
#define VEML7700_ALS_SD_SHIFT 0

#define VEML7700_COMMAND_ALS_WH 0x01

#define VEML7700_COMMAND_ALS_WL 0x02

#define VEML7700_COMMAND_PSM 0x03
#define VEML7700_PSM_MASK 0x0006
#define VEML7700_PSM_SHIFT 1

#define VEML7700_COMMAND_PSM_EN 0x03
#define VEML7700_PSM_EN_MASK 0x0001
#define VEML7700_PSM_EN_SHIFT 0

#define VEML7700_COMMAND_ALS 0x04

#define VEML7700_COMMAND_WHITE 0x05

#define VEML7700_COMMAND_ALS_IF_L 0x06
#define VEML7700_ALS_IF_L_MASK 0x8000
#define VEML7700_ALS_IF_L_SHIFT 15

#define VEML7700_COMMAND_ALS_IF_H 0x06
#define VEML7700_ALS_IF_H_MASK 0x4000
#define VEML7700_ALS_IF_H_SHIFT 14



typedef struct {
	I2CDriver* i2c;
	uint8_t addr;
	bool (*checkI2cFunc)(I2CDriver *driver);
    float lux;
	uint32_t registerCache[4];
} VEML7700_HandleTypedef;

void VEML7700_init_default_params(VEML7700_HandleTypedef* dev, I2CDriver* i2c);
void VEML7700_init_default_params_gain(VEML7700_HandleTypedef* dev, uint8_t als_gain);
bool VEML7700_init(VEML7700_HandleTypedef* dev);
bool VEML7700_getALSLux(VEML7700_HandleTypedef* dev);


#endif /* VEML7700_H_ */